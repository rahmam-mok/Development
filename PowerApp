Here is a **step-by-step guide to create a Power Automate flow that retrieves version history (including historical comments) from a SharePoint list** and **returns it to Power Apps using the REST API**.

---

## âœ… **Goal**

> Access a SharePoint column (e.g., **"Comments"** with **Append Changes to Existing Text** enabled) and retrieve **all version history** entries â€” then show it in **Power Apps**.

---

## ðŸ”§ **Prerequisites**

* SharePoint list with **Versioning enabled**
* "Comments" field with **Append Changes to Existing Text** enabled
* Power Apps app
* Power Automate license (free tier is fine)

---

## ðŸ” **Step-by-Step Power Automate Flow**

---

### ðŸ”¹ **Step 1: Create an Automated Cloud Flow**

1. Go to [Power Automate](https://make.powerautomate.com/)
2. Click **Create** > **Instant cloud flow**
3. Name it: `GetCommentsHistory`
4. Choose **Power Apps** as the trigger
5. Click **Create**

---

### ðŸ”¹ **Step 2: Add Power Apps Trigger Input**

1. Add an input to get the Item ID:

   * Click on **+ Add an input**
   * Choose **Number** and name it `ItemID`

---

### ðŸ”¹ **Step 3: Get the List Item**

1. Add a new action: **Get item**

   * Site Address: your SharePoint site
   * List Name: your list
   * ID: Use `ItemID` from Power Apps

---

### ðŸ”¹ **Step 4: Send an HTTP Request to SharePoint (to get version history)**

1. Add an action: **Send an HTTP request to SharePoint**

   * **Site Address**: Same as above

   * **Method**: `GET`

   * **Uri**:

     ```
     _api/web/lists/GetByTitle('YourListName')/items(@{triggerBody()['ItemID']})/versions
     ```

     Replace `'YourListName'` with the exact name of your SharePoint list. If there are spaces, use `%20` (e.g., `Project%20Tasks`).

   * **Headers**:

     * Key: `Accept`
     * Value: `application/json;odata=nometadata`

---

### ðŸ”¹ **Step 5: Parse the JSON Response**

1. Add action: **Parse JSON**

   * Content: `Body` from the HTTP action
   * Schema: Click **Generate from sample**

     * Paste a sample response from the SharePoint API. Here is an example snippet you can use:

```json
{
  "value": [
    {
      "VersionId": 512,
      "Created": "2024-03-05T15:31:01Z",
      "Editor": {
        "Title": "John Doe"
      },
      "FieldValuesAsText": {
        "Comments": "Initial comment"
      }
    }
  ]
}
```

---

### ðŸ”¹ **Step 6: Compose a Clean Response for Power Apps**

1. Add action: **Select** (from Data Operations)

   * From: `value` from **Parse JSON**
   * Map fields like this:

     * **Comment**: `item()['FieldValuesAsText']['Comments']`
     * **EditedBy**: `item()['Editor']['Title']`
     * **Modified**: `item()['Created']`

---

### ðŸ”¹ **Step 7: Respond to Power Apps**

1. Add **Respond to PowerApps** action:

   * Choose **Respond with a text value**
   * Use `json()` to convert `Select` output to string:

```powerapps
json(outputs('Select'))
```

---

## ðŸ“² **Power Apps Integration**

### ðŸ”¸ Step 1: Add a Button or OnVisible Event

Call the flow from Power Apps like this:

```powerapps
Set(
   commentHistoryJSON,
   GetCommentsHistory.Run(ThisItem.ID)
);
Set(
   commentHistory,
   JSON(commentHistoryJSON, JSONFormat.IncludeBinaryData)
)
```

> This sets `commentHistory` as a collection of parsed history entries.

---

### ðŸ”¸ Step 2: Show the Comments in a Gallery

1. Add a **Gallery** control
2. Set `Items` to:

```powerapps
Table(commentHistory)
```

3. Add Labels inside the gallery to show:

   * `ThisItem.Comment`
   * `ThisItem.EditedBy`
   * `ThisItem.Modified`

---

## âœ… Final Notes

* You can apply filters or formatting inside Power Apps as needed.
* Consider adding error handling in Power Automate in case a version doesn't contain the field value.
* REST API only returns **major versions** unless minor versioning is enabled.


